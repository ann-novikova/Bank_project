# Bank_project

## Проект, разработанный для банка, который будет готовить данные для виджета личного кабинета клиента.  Также виджет показывает несколько последних успешных банковских операций клиента. 

## Установка:

1. Клонируйте репозиторий:
```
https://github.com/ann-novikova/Bank_project.git
```

2. Установка Poetry

Если у вас еще не установлен Poetry, выполните следующую команду указанную на официальном сайте 
[Poetry](https://python-poetry.org/docs/#installing-with-the-official-installer)

После установки добавьте [Poetry](https://python-poetry.org/docs/#installing-with-the-official-installer) в PATH, 
если это не произошло автоматически:

```
export PATH="$HOME/.local/bin:$PATH"
```
3. Установка зависимостей

Используйте [Poetry](https://python-poetry.org/docs/#installing-with-the-official-installer) для создания виртуального окружения и установки 
зависимостей (включая инструменты для разработки, 
такие как flake8, isort, black и mypy):

poetry install

4. Активация виртуального окружения

Активируйте виртуальное окружение [Poetry](https://python-poetry.org/docs/#installing-with-the-official-installer) в зависимости от версии

## Использование:

Модули, входящие в проект:
* Модуль masks.py
* Модуль widget.py
* Модуль processing.py
* Модуль generators.py
* Модуль decorators.py
* Модуль external_api.py
* Модуль utils.py
* Модуль read_files.py
* Модуль search.py

### Модуль masks.py

Модуль для маскировки номера счета или номера карты клиента.
Например, функция принимает на вход номер карты и счета и возвращает маску в формате XXXX XX** **** XXXX для карты и 
**XXXX для счета.

### Модуль widget.py

Модуль получения типа и номера карты или счета, а также преобразования даты, полученной из банковской системы в 
формат ДД.ММ.ГГГГ.

### Модуль processing.py

Модуль работы со списком словарей и опциональными значениями для ключа и сортировки статуса операций.

Использование:
Введите информацию о банковский операциях в файле main.py (в виде списка словарей)
Функция `filter_by_state(bank_transactions, state)` принимает информацию о банковских операциях и фильтрует по указанному
статусу ('EXECUTED' or 'CANCELED'), по умолчанию сортировка производится по 'EXECUTED'.
Функция `sort_by_date(bank_transactions)`принимает информацию о банковских операциях и сортирует по дате (можно указать
порядок сортировки - True or False)

**Пример**:
Пример входных данных для проверки функции:
```
[{'id': 41428829, 'state': 'EXECUTED', 'date': '2019-07-03T18:35:29.512364'}, 
{'id': 939719570, 'state': 'EXECUTED', 'date': '2018-06-30T02:08:58.425572'}, 
{'id': 594226727, 'state': 'CANCELED', 'date': '2018-09-12T21:27:25.241689'}, 
{'id': 615064591, 'state': 'CANCELED', 'date': '2018-10-14T08:21:33.419441'}]
``` 

Вывод функции:
filter_by_state:
```
[{'id': 41428829, 'state': 'EXECUTED', 'date': '2019-07-03T18:35:29.512364'}, 
{'id': 939719570, 'state': 'EXECUTED', 'date': '2018-06-30T02:08:58.425572'}]
```

sort_by_date:
```
[{'id': 41428829, 'state': 'EXECUTED', 'date': '2019-07-03T18:35:29.512364'}, 
{'id': 615064591, 'state': 'CANCELED', 'date': '2018-10-14T08:21:33.419441'}, 
{'id': 594226727, 'state': 'CANCELED', 'date': '2018-09-12T21:27:25.241689'}, 
{'id': 939719570, 'state': 'EXECUTED', 'date': '2018-06-30T02:08:58.425572'}]
```

### Модуль generators.py

Модуль для эффективной работы с большими объемами данных, использующий генераторы:
* Функция filter_by_currency фильтрует список транзакций по заданной валюте. Возвращает "Операции по данной валюте 
отсутствуют", если транзакции с указанной валютой не найдены.
* Функция transaction_descriptions принимает выгрузку транзакций и возвращает их описание.
* Функция card_number_generator, которая генерирует номера карт от 1 до 10000000000000000 в шестнадцати-значном 
формате 'ХХХХ ХХХХ ХХХХ ХХХХ'

### Модуль decorators.py

Декоратор log автоматически логирует начало и конец выполнения функции, а также ее результаты или возникшие ошибки.
Декоратор должен принимает необязательный аргумент filename, который определяет, куда будут записываться логи 
(в файл или в консоль).

### Модуль external_api.py

Функцию convert_currency принимает на вход транзакцию и возвращает сумму транзакции (amount) в рублях, тип данных — 
float . Если транзакция была в USD или EUR, происходит обращение к внешнему API для получения текущего курса валют и 
конвертации суммы операции в рубли. 
Для конвертации валюты воспользуйтесь Exchange Rates Data API: 
[Exchange Rates Data API](https://apilayer.com/exchangerates_data-api). 

Используйте переменные окружения из файла .env.example для сокрытия чувствительных данных (токенов доступа для API). 

### Модуль utils.py

Функция, которая принимает на вход путь до JSON-файла и возвращает список словарей с данными о финансовых транзакциях. 
Если файл пустой, содержит не список или не найден, функция возвращает пустой список.

Пример файла с данными о финансовых транзакциях называется operations.json и находится в директории data/ в корне 
проекта.

### Модуль read_files.py
Реализованы функции для считывания CSV и Excel файлов, которые возвращают список транзакций. Примеры обрабатываемых
файлов вы можете найти в папке data/.

### Модуль search.py
Модуль для поиска по ключевому слову и подсчет количества групп.

## Тестирование:

Наш проект покрыт юнит-тестами Pytest with 100% coverage.


## Лицензия:

Этот проект лицензирован по [лицензии MIT](LICENSE).